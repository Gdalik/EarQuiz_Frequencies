environment:
  matrix:
    - PYTHON: "C:\\Python310-x64"
      PYTHON_VERSION: "3.10.11"
      PYTHON_ARCH: "64"

platform: x64

configuration: Release

init:
  - cmd: ver
  - cmd: ECHO Processor architecture - %PROCESSOR_ARCHITECTURE%
  - cmd: wmic OS get OSArchitecture

  # As AppVeyor has multiple python install, check which one uses by default
  - cmd: ECHO %PYTHON% %PYTHON_VERSION% %PYTHON_ARCH%
  - cmd: python --version
  - cmd: python -c "import struct; print(struct.calcsize('P') * 8)"
  - cmd: python -c "import sys; print(sys.executable)"

  # Set the relevant Python and pip location to the path
  - cmd: set PATH=%PYTHON%;%PYTHON%\scripts;%PATH%
  - cmd: ECHO Path - %PATH%

  # Verify the new default python
  - cmd: python --version
  - cmd: python -c "import struct; print(struct.calcsize('P') * 8)"
  - cmd: python -c "import sys; print(sys.executable)"
  - cmd: pip3 --version

  # Check out installed python packages
  - cmd: pip3 freeze

install:
  # Fix for PyQt not being installed in correct directory: https://github.com/appveyor/ci/issues/363
  - cmd: REG ADD HKCU\Software\Python\PythonCore\3.10\InstallPath /f /ve /t REG_SZ /d C:\Python310-x64
  - cmd: pip3 install -r requirements.txt
  # - cmd: pip3 uninstall -y PyQt6 pyqt6-plugins PyQt6-Qt6 PyQt6-sip pyqt6-tools qt6-applications qt6-tools
  - ps: pip3 uninstall -y PyQt6 PyQt6-Qt6 PyQt6-sip
  - ps: pip3 install PyQt6
  - cmd: pip3 install -U pyinstaller==5.13.2
  - cmd: pyinstaller windows_build.spec

artifacts:
  - path: dist\main
    name: EQ_Freq

# Not a project with an msbuild file, build done at install.
build: None